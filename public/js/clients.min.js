$(()=>{function e(e,t=!1){$.ajax({url:ADDRESS_URL,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},type:"POST",dataType:"json",data:{cep:e},success:function(e){!1===t?n(e.address):n(e.address,!0)},error:function(){alert("algo deu errado!")}})}function n(e,n=!1){!1===n?($("input[name=street]").val(e.logradouro),$("input[name=neighborhood]").val(e.bairro),$("input[name=city]").val(e.localidade),$("select[name=state]").find("option").each((function(){$(this).val()===e.uf&&$(this).prop("selected",!0)}))):($("input[name=street_payment_collection]").val(e.logradouro),$("input[name=neighborhood_payment_collection]").val(e.bairro),$("input[name=city_payment_collection]").val(e.localidade),$("select[name=state_payment_collection]").find("option").each((function(){$(this).val()===e.uf&&$(this).prop("selected",!0)})))}i(),$("input[name=cep]").mask("99999-999",{completed:function(){e(this.val())}}),$("input[name=cep_payment_collection]").mask("99999-999",{completed:function(){e(this.val(),!0)}}),0==edit&&cpf_representative_register&&($("#card-Cnpj").css("display","block"),$("#card-Cpf").css("display","none"),$("input[name=representative_cpf]").addClass("inputOk"));var t=[];function a(){(t=[]).street=$("#address_client").find("input[name=street]").val(),t.number=$("#address_client").find("input[name=number]").val(),t.neighborhood=$("#address_client").find("input[name=neighborhood]").val(),t.city=$("#address_client").find("input[name=city]").val(),t.state=$("#address_client").find("select[name=state]").find("option:selected").val(),t.complement=$("#address_client").find("input[name=complement]").val(),t.cep=$("#address_client").find("input[name=cep]").val()}function i(){"1"===$("#kind_person").find("option:selected").val()&&($("#card-Cpf").css("display","block"),$("#card-Cnpj").css("display","none")),"2"===$("#kind_person").find("option:selected").val()&&($("#card-Cnpj").css("display","block"),$("#card-Cpf").css("display","none"),$("input[name=cnpj]").mask("99.999.999/9999-99",{completed:function(){var e;e=this.val(),$.ajax({url:CNPJ_URL,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},type:"POST",data:{cnpj:e},dataType:"json",success:function(e){!function(e){""!=e.fantasia?$("#company_name").val(e.fantasia):$("#company_name").val(e.nome),$("input[name=email]").val(e.email),$("#address_client").find("input[name=street]").val(e.logradouro),$("#address_client").find("input[name=number]").val(e.numero),$("#address_client").find("input[name=neighborhood]").val(e.bairro),$("#address_client").find("input[name=complement]").val(e.complemento),$("#address_client").find("input[name=city]").val(e.municipio),$("#address_client").find("input[name=cep]").val(e.cep.replace(".","")),$("select[name=state]").find("option").each((function(){$(this).val()===e.uf&&$(this).prop("selected",!0)}))}(e.cnpj_info)}})}}))}function s(e,n){if(!1===p(n))$("input[name=representative_cpf]").val(""),$("input[name=representative_cpf]").removeClass("inputDanger"),$("input[name=representative_cpf]").removeClass("inputOk"),Swal.fire({icon:"error",text:"Cpf Inválido",customClass:"mySweetalert"});else if(0!=e)$("input[name=representative_cpf]").addClass("inputOk"),$("#idRepresentative").val(e),$("#btnRegister").css("display","none");else if(0==e){$("input[name=representative_cpf]").addClass("inputDanger"),$("#btnRegister").css("display","flex");let e=$("input[name=representative_cpf]").val(),n="";!1===edit?(n=BASE_URL+"/addClient/"+e,$("#idRepresentative").val("")):($("#idRepresentative").val(idClientRepresentative),n=BASE_URL+"/addClient/"+e+"/"+idClient),$("#btnRegister").attr("href",n)}}function p(e){if("string"!=typeof e)return!1;if(11!==(e=e.replace(/[\s.-]*/gim,"")).length||!Array.from(e).filter(n=>n!==e[0]).length)return!1;for(var n,t=0,a=1;a<=9;a++)t+=parseInt(e.substring(a-1,a))*(11-a);if(10!=(n=10*t%11)&&11!=n||(n=0),n!=parseInt(e.substring(9,10)))return!1;t=0;for(a=1;a<=10;a++)t+=parseInt(e.substring(a-1,a))*(12-a);return 10!=(n=10*t%11)&&11!=n||(n=0),n==parseInt(e.substring(10,11))}function o(e){if(!e)return!1;if(!("string"==typeof e||Number.isInteger(e)||Array.isArray(e)))return!1;const n=e.toString().match(/\d/g),t=Array.isArray(n)?n.map(Number):[];if(14!==t.length)return!1;if(1===[...new Set(t)].length)return!1;const a=e=>{const n=t.slice(0,e);let a=e-7,i=0;for(let t=e;t>=1;t--){i+=n[e-t]*a--,a<2&&(a=9)}const s=11-i%11;return s>9?0:s},i=t.slice(12);if(a(12)!==i[0])return!1;return a(13)===i[1]}a(),$("#kind_person").on("change",(function(){i()})),$("#marital_status").on("change",(function(){"2"===$(this).find("option:selected").val()?$("#card-spouse").css("display","block"):($("#card-spouse").css("display","none"),$("#card-spouse").find("input").val(""))})),$("input[name=representative_cpf]").mask("999.999.999-99",{completed:function(){var e;e=this.val(),$.ajax({url:CPF_URL,type:"POST",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:{cpf:e},dataType:"json",success:function(n){s(n,e)},error:function(){alert("algo deu errado")}})}}),$("input[name=representative_cpf]").on("keyup",(function(e){let n=e.keyCode;8!==n&&46!==n||($("input[name=representative_cpf]").removeClass("inputDanger"),$("input[name=representative_cpf]").removeClass("inputOk"),$("#btnRegister").css("display","none"))})),$("#btnCopyAddress").on("click",(function(e){a(),e.preventDefault(),$("#address_payment_collection").find("input[name=cep_payment_collection]").val(t.cep),$("#address_payment_collection").find("input[name=street_payment_collection]").val(t.street),$("#address_payment_collection").find("input[name=number_payment_collection]").val(t.number),$("#address_payment_collection").find("input[name=city_payment_collection]").val(t.city),$("#address_payment_collection").find("input[name=neighborhood_payment_collection]").val(t.neighborhood),$("#address_payment_collection").find("input[name=complement_payment_collection]").val(t.complement),$("#state_payment_collection").find("option").each((function(){$(this).val()==t.state&&$(this).prop("selected",!0)}))})),$("input[name=cpf]").mask("999.999.999-99",{completed:function(){!1===p(this.val())&&($("input[name=cpf]").val(""),Swal.fire({icon:"error",text:"Cpf Inválido",customClass:"mySweetalert"}))}}),$("input[name=spouse_cpf]").mask("999.999.999-99",{completed:function(){!1===p(this.val())&&($("input[name=spouse_cpf]").val(""),Swal.fire({icon:"error",text:"Cpf Inválido",customClass:"mySweetalert"}))}}),$("input[name=cnpj]").mask("99.999.999/9999-99",{completed:function(){!1===o(this.val())&&($("input[name=cnpj]").val(""),Swal.fire({icon:"error",text:"CNPJ Inválido",customClass:"mySweetalert"}))}}),$("input[name=spouse_cnpj]").mask("99.999.999/9999-99",{completed:function(){!1===o(this.val())&&($("input[name=spouse_cnpj]").val(""),Swal.fire({icon:"error",text:"CNPJ Inválido",customClass:"mySweetalert"}))}});var l=[],c=$(".phoneArea__item").eq(0),r=$(".phoneArea");"false"===$(r).attr("edit")?$(".phoneArea").empty():"true"===$(r).attr("edit")&&$(".phoneArea__item").find("input").each((function(){let e=$(this).closest(".phoneArea__item").attr("whatsApp");e=null!=e,l.push({id:l.length,phone:$(this).val(),whatsApp:e})})),$("#btnAddPhone").prop("disabled",!0),$("#phoneSelected").mask("(99)99999-9999",{completed:function(){$("#btnAddPhone").prop("disabled",!1)}}),$("#btnAddPhone").on("click",(function(e){e.preventDefault();let n=$("#phoneSelected").val(),t=!1;0==l.length&&(t=!0),l.push({id:l.length,phone:n,whatsApp:t}),$("#phoneSelected").val(""),function e(n){$(r).empty(),$.each(n,(function(e,n){let t=$(c).clone();console.log(n.whatsApp),n.whatsApp?($(t).find(".btnWhatsApp").removeClass("whatsApp__disabled"),$(t).find(".btnWhatsApp").addClass("whatsApp")):($(t).find(".btnWhatsApp").removeClass("whatsApp"),$(t).find(".btnWhatsApp").addClass("whatsApp__disabled")),$(t).css("display","flex"),$(t).find("input").val(n.phone),$(t).find(".btnDeletePhone").attr("key",n.id),$(r).append(t)})),$(".btnDeletePhone").each((function(){$(this).on("click",(function(){let t=parseInt($(this).attr("key"));n.splice(t,1),$.each(n,(function(e,t){n[e].id=e})),e(n)}))})),$(".btnWhatsApp").each((function(){$(this).on("click",(function(){$(".btnWhatsApp").each((function(){$(this).removeClass("whatsApp"),$(this).addClass("whatsApp__disabled")})),$(this).removeClass("whatsApp__disabled"),$(this).addClass("whatsApp");let e=$(this).closest(".phoneArea__item").find("input").val();$("#whatsAppNumber").val(e)}))}))}(l),$("#btnAddPhone").prop("disabled",!0)}))});